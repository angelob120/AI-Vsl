{"ast":null,"code":"var _s = $RefreshSig$();\n// FILE: src/components/RepliqStudio/hooks/useCSVData.js\nimport { useState, useEffect, useRef } from 'react';\nimport { readFileAsText } from '../utils/fileHelpers';\n\n// Simple CSV parser\nconst parseCSV = text => {\n  const lines = text.split('\\n');\n  return lines.map(line => {\n    const result = [];\n    let current = '';\n    let inQuotes = false;\n    for (let i = 0; i < line.length; i++) {\n      const char = line[i];\n      if (char === '\"') {\n        inQuotes = !inQuotes;\n      } else if (char === ',' && !inQuotes) {\n        result.push(current.trim());\n        current = '';\n      } else {\n        current += char;\n      }\n    }\n    result.push(current.trim());\n    return result;\n  }).filter(row => row.some(cell => cell));\n};\nexport function useCSVData(importedCSV = null) {\n  _s();\n  const [csvData, setCsvData] = useState([]);\n  const [csvHeaders, setCsvHeaders] = useState([]);\n  const [headerRowIndex, setHeaderRowIndex] = useState(0);\n  const [columnMapping, setColumnMapping] = useState({\n    websiteUrl: '',\n    firstName: '',\n    companyName: ''\n  });\n  const [leads, setLeads] = useState([]);\n  const inputRef = useRef(null);\n\n  // Handle file upload\n  const handleUpload = async e => {\n    var _e$target$files;\n    const file = (_e$target$files = e.target.files) === null || _e$target$files === void 0 ? void 0 : _e$target$files[0];\n    if (!file) return;\n    try {\n      const text = await readFileAsText(file);\n      const parsed = parseCSV(text);\n      if (parsed && parsed.length > 0) {\n        setCsvData(parsed);\n        setCsvHeaders(parsed[0] || []);\n      }\n    } catch (error) {\n      console.error('CSV parse error:', error);\n    }\n  };\n\n  // Handle imported CSV from props\n  useEffect(() => {\n    if (importedCSV && importedCSV.length > 0) {\n      setCsvData(importedCSV);\n      setCsvHeaders(importedCSV[0] || []);\n    }\n  }, [importedCSV]);\n\n  // Update leads when data or mapping changes\n  useEffect(() => {\n    if (csvData.length <= headerRowIndex + 1 || !columnMapping.companyName) {\n      setLeads([]);\n      return;\n    }\n    const headers = csvData[headerRowIndex];\n    const newLeads = [];\n    for (let i = headerRowIndex + 1; i < csvData.length; i++) {\n      const row = csvData[i];\n      const lead = {\n        websiteUrl: columnMapping.websiteUrl ? row[headers.indexOf(columnMapping.websiteUrl)] : '',\n        firstName: columnMapping.firstName ? row[headers.indexOf(columnMapping.firstName)] : '',\n        companyName: columnMapping.companyName ? row[headers.indexOf(columnMapping.companyName)] : ''\n      };\n      if (lead.companyName || lead.firstName) {\n        newLeads.push(lead);\n      }\n    }\n    setLeads(newLeads);\n  }, [csvData, columnMapping, headerRowIndex]);\n  const triggerUpload = () => {\n    var _inputRef$current;\n    (_inputRef$current = inputRef.current) === null || _inputRef$current === void 0 ? void 0 : _inputRef$current.click();\n  };\n  const updateMapping = (field, value) => {\n    setColumnMapping(prev => ({\n      ...prev,\n      [field]: value\n    }));\n  };\n  const reset = () => {\n    setCsvData([]);\n    setCsvHeaders([]);\n    setLeads([]);\n    setColumnMapping({\n      websiteUrl: '',\n      firstName: '',\n      companyName: ''\n    });\n    if (inputRef.current) {\n      inputRef.current.value = '';\n    }\n  };\n  return {\n    csvData,\n    csvHeaders,\n    headerRowIndex,\n    setHeaderRowIndex,\n    columnMapping,\n    updateMapping,\n    leads,\n    inputRef,\n    handleUpload,\n    triggerUpload,\n    reset,\n    hasData: csvData.length > 0\n  };\n}\n_s(useCSVData, \"pgX2xhoxApqL2fFwGxmFy5bIbGA=\");","map":{"version":3,"names":["useState","useEffect","useRef","readFileAsText","parseCSV","text","lines","split","map","line","result","current","inQuotes","i","length","char","push","trim","filter","row","some","cell","useCSVData","importedCSV","_s","csvData","setCsvData","csvHeaders","setCsvHeaders","headerRowIndex","setHeaderRowIndex","columnMapping","setColumnMapping","websiteUrl","firstName","companyName","leads","setLeads","inputRef","handleUpload","e","_e$target$files","file","target","files","parsed","error","console","headers","newLeads","lead","indexOf","triggerUpload","_inputRef$current","click","updateMapping","field","value","prev","reset","hasData"],"sources":["/Users/ab/inase tools/contractor-builder/src/components/RepliqStudio/hooks/useCSVData.js"],"sourcesContent":["// FILE: src/components/RepliqStudio/hooks/useCSVData.js\nimport { useState, useEffect, useRef } from 'react';\nimport { readFileAsText } from '../utils/fileHelpers';\n\n// Simple CSV parser\nconst parseCSV = (text) => {\n  const lines = text.split('\\n');\n  return lines.map(line => {\n    const result = [];\n    let current = '';\n    let inQuotes = false;\n    \n    for (let i = 0; i < line.length; i++) {\n      const char = line[i];\n      \n      if (char === '\"') {\n        inQuotes = !inQuotes;\n      } else if (char === ',' && !inQuotes) {\n        result.push(current.trim());\n        current = '';\n      } else {\n        current += char;\n      }\n    }\n    result.push(current.trim());\n    return result;\n  }).filter(row => row.some(cell => cell));\n};\n\nexport function useCSVData(importedCSV = null) {\n  const [csvData, setCsvData] = useState([]);\n  const [csvHeaders, setCsvHeaders] = useState([]);\n  const [headerRowIndex, setHeaderRowIndex] = useState(0);\n  const [columnMapping, setColumnMapping] = useState({\n    websiteUrl: '',\n    firstName: '',\n    companyName: ''\n  });\n  const [leads, setLeads] = useState([]);\n  const inputRef = useRef(null);\n\n  // Handle file upload\n  const handleUpload = async (e) => {\n    const file = e.target.files?.[0];\n    if (!file) return;\n\n    try {\n      const text = await readFileAsText(file);\n      const parsed = parseCSV(text);\n      \n      if (parsed && parsed.length > 0) {\n        setCsvData(parsed);\n        setCsvHeaders(parsed[0] || []);\n      }\n    } catch (error) {\n      console.error('CSV parse error:', error);\n    }\n  };\n\n  // Handle imported CSV from props\n  useEffect(() => {\n    if (importedCSV && importedCSV.length > 0) {\n      setCsvData(importedCSV);\n      setCsvHeaders(importedCSV[0] || []);\n    }\n  }, [importedCSV]);\n\n  // Update leads when data or mapping changes\n  useEffect(() => {\n    if (csvData.length <= headerRowIndex + 1 || !columnMapping.companyName) {\n      setLeads([]);\n      return;\n    }\n\n    const headers = csvData[headerRowIndex];\n    const newLeads = [];\n\n    for (let i = headerRowIndex + 1; i < csvData.length; i++) {\n      const row = csvData[i];\n      const lead = {\n        websiteUrl: columnMapping.websiteUrl \n          ? row[headers.indexOf(columnMapping.websiteUrl)] \n          : '',\n        firstName: columnMapping.firstName \n          ? row[headers.indexOf(columnMapping.firstName)] \n          : '',\n        companyName: columnMapping.companyName \n          ? row[headers.indexOf(columnMapping.companyName)] \n          : ''\n      };\n      \n      if (lead.companyName || lead.firstName) {\n        newLeads.push(lead);\n      }\n    }\n    \n    setLeads(newLeads);\n  }, [csvData, columnMapping, headerRowIndex]);\n\n  const triggerUpload = () => {\n    inputRef.current?.click();\n  };\n\n  const updateMapping = (field, value) => {\n    setColumnMapping(prev => ({ ...prev, [field]: value }));\n  };\n\n  const reset = () => {\n    setCsvData([]);\n    setCsvHeaders([]);\n    setLeads([]);\n    setColumnMapping({ websiteUrl: '', firstName: '', companyName: '' });\n    if (inputRef.current) {\n      inputRef.current.value = '';\n    }\n  };\n\n  return {\n    csvData,\n    csvHeaders,\n    headerRowIndex,\n    setHeaderRowIndex,\n    columnMapping,\n    updateMapping,\n    leads,\n    inputRef,\n    handleUpload,\n    triggerUpload,\n    reset,\n    hasData: csvData.length > 0\n  };\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}